<!DOCTYPE html>
<html lang="no">

<head>
  <meta charset="UTF-8" />
  <title>Filnavnrenser</title>
  <link rel="stylesheet" href="/assets/css/theme-tÃ¸ff.css" />
  <style>
    body {
      padding: 2rem;
      font-family: sans-serif;
    }

    ul {
      margin-top: 1rem;
    }

    .mangler {
      color: red;
    }

    .finnes {
      color: green;
    }
  </style>
</head>

<body>
  <h1>ğŸ”§ Filnavnsjekk for butikkbilder</h1>
  <ul id="filnavnListe"></ul>

  <script>
    function sluggify(str) {
      return str.toLowerCase()
        .replace(/Ã¥/g, "a").replace(/Ã¸/g, "o").replace(/Ã¦/g, "ae")
        .replace(/[^a-z0-9]+/g, "-")
        .replace(/(^-|-$)/g, "");
    }

    async function fetchImageList() {
      // Denne mÃ¥ inneholde en forhÃ¥ndsgenerert liste over filer i mappe
      const res = await fetch("../../assets/data/butikker-webp-index.json");
      return res.ok ? await res.json() : [];
    }

    async function init() {
      const ul = document.getElementById("filnavnListe");
      const bildeFiler = await fetchImageList();

      fetch("../../assets/data/butikker.json")
        .then(res => res.json())
        .then(butikker => {
          butikker.forEach(b => {
            const navn = b.name || "ukjent";
            const slug = sluggify(navn);
            const foreslÃ¥ttFil = `${slug}.webp`;
            const finnes = bildeFiler.includes(foreslÃ¥ttFil);

            const li = document.createElement("li");
            li.innerHTML = `${navn} â†’ <code>assets/images/butikker-webp/${foreslÃ¥ttFil}</code>` +
              ` <strong class="${finnes ? 'finnes' : 'mangler'}">[${finnes ? 'âœ“ finnes' : 'âœ— mangler'}]</strong>`;
            ul.appendChild(li);
          });
        });
    }

    init();
  </script>
</body>

</html>